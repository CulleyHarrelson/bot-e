extends layout
include mixins

block content
  if !answer
    head
      meta(http-equiv="refresh" content="20")
    style.
      /* Define keyframes for the animation */
      @keyframes progress-animation {
        0% {
          width: 0;
        }
        100% {
          width: 100%;
        }
      }

      /* Apply the animation to the progress bar */
      .progress-meter-animated {
        animation-name: progress-animation;
        animation-timing-function: linear;
        animation-fill-mode: forwards; /* Keep the final style after animation */
      }

      /* Style the container as needed */
      .progress-container {
        width: 100%;
        height: 20px; /* Adjust height as needed */
        background-color: #f0f0f0;
        border-radius: 5px;
        overflow: hidden; /* Hide overflowing content during animation */
      }

    script.
      document.addEventListener("DOMContentLoaded", function () {
        var progressMeter = document.querySelector(".progress-meter");
        progressMeter.style.animationDuration = "20s";
        // Start the animation by adding the animated class
        progressMeter.classList.add("progress-meter-animated");
      });
  else
    script(src='https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js')
    script.
      document.addEventListener('DOMContentLoaded', () => {
        const clipboard = new ClipboardJS('#copy-button', {
          text: () => window.location.href
        });

        clipboard.on('success', (e) => {
          e.clearSelection();

          const notice = document.createElement('div');
          notice.textContent = 'Link copied to clipboard';
          notice.classList.add('callout', 'success');
          document.body.appendChild(notice);

          setTimeout(() => {
            document.body.removeChild(notice);
          }, 3000); // Remove notice after 3 seconds
        });
      });
  +topBar

  .grid-container
    .grid-x.grid-margin-x.small-12
      .grid-x.grid-margin-x(style="padding-top: 20px;")
        .cell.small-12
          h4 Question:
          p.cell.lead !{question}
    if answer
      .grid-x.grid-margin-x
        .cell.small-12
          h4 bot-e:
          p.cell.small-12 !{answer}

          .cell.small-12.text-center(style="padding-top: 20px;")
            button.button(type='button', id='copy-button') Share
    else
      .grid-x.grid-margin-x
        .cell.small-12
          h5 bot-e:
          p.cell.small-12 It can take me 20-30 seconds to compose my response - this page will refresh every 20 seconds until I have responded.
        .cell.small-12
          .progress-container
            .progress-meter(role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuetext="100 percent" aria-valuemax="100")
              span.progress-meter-text
        .cell.small-12.text-center(style="padding-top: 20px;")
          button.button(type='button', onclick='location.reload();') I'm tired of waiting, refresh now!
